# 深度理解本机网络IO

## 深度理解本机网络IO

### 实际问题又来了

讨论本机网络的情况, 127.0.0.1. 实际的意义比如:nginx　php-fpm　通过本机来通信的.sidecar也是本机io

### 回顾跨机网络通信过程

都是一些回顾内容, 没什么新的, 不过可以拿过来当成总结还是挺好的.

### 本机发送过程

有两个地方与跨机不一样, 路由和驱动.

#### 网络层路由

本机网络只查到像local就可以了, 同样会使用io虚拟网卡. 区别在于MTU会比较大.

#### 本机路由

即使本机IP不使用127.0.0.1, 内核仍然会使用IO虚拟网卡.

#### 网络设备子系统

没有队列问题

#### 驱动程序

虚拟接口, 不是真正意义上的物理驱动. 仍然需要SKB, 只是不需要释放, 直接传给对方.同样需要软中断.

### 本机接收过程

直接从软中断开始, 没有硬中断.

### 总结

本机网络IO需要经过网卡吗

```
不需要, 直接虚拟网卡.
```

数据包走向与外网发送有什么区别

```
不需要进RINGBUFFER, 节省一点开销. 但是其他开销没有节省. 
eBRF 可以绕开协议栈.
```

使用127.0.0.1 能比使用本机IP更快吗?

```
并不会
```
